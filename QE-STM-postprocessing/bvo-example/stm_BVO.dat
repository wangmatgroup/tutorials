#!/bin/sh

# input file for stm_run.sh
# example of BiVO4 (010) surface with stoichiometry termination
# created: wwwennie


# system parameters
prefix="66-s25v20"                         ## should match *.save
sample_bias_neg=0.14699 
sample_bias_pos=${sample_bias_neg} # Ry


# running parameters
# see stm_run.sh for full list
PREFIX="/home/wwwennie/bin2/qe-6.3"
PSEUDO_DIR=$PREFIX/pseudo
PARA_PREFIX="mpirun -np 48"
PARA_POSTFIX=" -nk 4 -nd 4 -nb 1 -nt 1 "


# pp 
# plotting plane vectors and origin
# in units of alat; generates plot with repeated cells
e1=(7.0 0.0 0.0)
e2=(0.0 7.0 0.0)
x0=(0.0 -0.0 1.6742) # somewhere in bulk, on atom slice 
nx=36
ny=56

# plotrho
# stm @ bias 
# choose rho* from ${prefix}-neg or ${prefix}-pos
rhomin_neg=0.00000006
rhomax_neg=0.0000004
rhomin_pos=0.0000001
rhomax_pos=0.0000006
nlevels=8

# stm @ bias, constant current
nx_c=150
ny_c=150
isovalue=1e-6
# height*=[0,1], % wrt cell height
# put heighmin somewhere in bulk, heightmax somewhere in vacuum 
heightmin=0.7
heightmax=0.9
direction=1 # +/- 1

# LDOS boxes
degauss=0.001
DeltaE=0.002
n_proj_boxes=8

# sum pdos atom list
pdos_atoms=("Bi" "V")
eFermi=4.2  # eV, approx from nscf_10

# cat for boxes
# at 90 Ry, BVO FFT = (60 60 675)
# surf1 @ 0.78
# surf2 @ 0.21
vac1_min=575
vac1_max=590
vac2_min=100
vac2_max=110
cat > tmp_box << EOF
!! Boxes centered on the first vacuum layer:
  !! 1) above the surface V
    irmin(1,1)= 0, irmax(1,1)= 4, irmin(2,1)= 5, irmax(2,1)= 20, irmin(3,1)=${vac1_min}, irmax(3,1)=${vac1_max},
  !! 2) above surface Bi
    irmin(1,2)=25, irmax(1,2)=35, irmin(2,2)= 5, irmax(2,2)= 20, irmin(3,2)=${vac1_min}, irmax(3,2)=${vac1_max},
  !! 3) across surface V
    irmin(1,3)= 1, irmax(1,3)=25, irmin(2,3)=1, irmax(2,3)=60, irmin(3,3)=${vac1_min}, irmax(3,3)=${vac1_max},
  !! 4) across surface Bi -> V
    irmin(1,4)= 1, irmax(1,4)=60, irmin(2,4)= 1, irmax(2,4)=25, irmin(3,4)=${vac1_min}, irmax(3,4)=${vac1_max},

!! Same as above, centered on the second vacuum layer:
    irmin(1,5)= 0, irmax(1,5)= 4, irmin(2,5)= 5, irmax(2,5)= 20, irmin(3,5)=${vac2_min}, irmax(3,5)=${vac2_max},
    irmin(1,6)=25, irmax(1,6)=35, irmin(2,6)= 5, irmax(2,6)= 20, irmin(3,6)=${vac2_min}, irmax(3,6)=${vac2_max},
    irmin(1,7)= 1, irmax(1,7)=25, irmin(2,7)=1, irmax(2,7)=60, irmin(3,7)=${vac2_min}, irmax(3,7)=${vac2_max},
    irmin(1,8)= 1, irmax(1,8)=60, irmin(2,8)= 1, irmax(2,8)=25, irmin(3,8)=${vac2_min}, irmax(3,8)=${vac2_max},
 /
EOF
